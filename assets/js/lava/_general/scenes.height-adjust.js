// Generated by CoffeeScript 1.3.3

/*
Height adjust callbacks
*/


(function() {

  (function($, window, document) {
    var methods, namespace;
    methods = {};
    namespace = 'lavaHeightAdjust';
    methods.init = function(e, lava) {
      return $(lava).each(function() {
        var $blocks;
        $blocks = $(this).find('.lava-scene.js-height-adjust');
        $blocks.on("load.lava." + namespace, methods.load);
        return $(window).on("resize.lava." + namespace, methods.resizeWindow);
      });
    };
    methods.load = function(e) {
      $(this).attr('data-height-adjust-min', $(this).height());
      return setTimeout(methods.resizeWindow, 100);
    };
    methods.resizeWindow = function(e) {
      return $('.lava-scene.js-height-adjust').each(methods.resize);
    };
    methods.resize = function() {
      var $this, doc_height, loop_count, min_height, old_doc_height, win_height, _results;
      $this = $(this);
      doc_height = $(document).height();
      win_height = $(window).height();
      min_height = $this.attr('data-height-adjust-min');
      if (doc_height === win_height) {
        loop_count = 0;
        while ((doc_height === win_height) && (loop_count < 1000)) {
          loop_count += 1;
          $this.height($this.height() + 1);
          doc_height = $(document).height();
          win_height = $(window).height();
        }
        $this.height($this.height() - 1);
      }
      old_doc_height = doc_height = $(document).height();
      if ((doc_height > win_height) && ($this.height() > min_height)) {
        $this.height($this.height() - 1);
        doc_height = $(document).height();
        _results = [];
        while ((doc_height > win_height) && (old_doc_height > doc_height) && ($this.height() > min_height)) {
          old_doc_height = doc_height;
          $this.height($this.height() - 1);
          _results.push(doc_height = $(document).height());
        }
        return _results;
      }
    };
    return lavaBindMethods(methods, namespace);
  })(jQuery, window, document);

}).call(this);
